<!------------------------------------------------------------------------------->
<!--              Generated by makedocs.pl version 1.0 rev 20                  -->
<!--              This file Copyright (c) POV-Team 1991-2002                   -->
<!-- You can override our stylesheet settings by placing a 'povray35.css' file -->
<!--    in the root directory of the disk volume that holds this help file.    -->
<!------------------------------------------------------------------------------->
<html>
<head>
<title>CSG Pitfalls</title>
<link rel="stylesheet" type="text/css" href="../povray35.css">
<link rel="stylesheet" type="text/css" href="file:///povray35.css">
<object id=htmlhelp type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"></object>
<script language=javascript src="../povray35.js"></script>
</head>
<a name="target_108"></a>
<body>
<center>
<table width=100% border=0>
<tr>
<td>
<table width=100% align="center" border=0 bgcolor="#ffcc99" class="NavBar">
<tr>
<td align="left">&lt;<a href="povdoc_066.html">Prev</a></td>
<script language="JavaScript">
<!--
if (navigator.userAgent.indexOf ("MSIE 3.") >= 1)
  document.write ("<td align=center><small><i>You are running <b>IE3</b>. This will likely cause problems with this help file.</i></small></td>") ;
else if (navigator.userAgent.indexOf ("MSIE 4.") >= 1)
  document.write ("<td align=center><small><i>The Microsoft HTML Help system works best with <b>IE5</b> or later. We recommend you upgrade.</i></small></td>") ;
//-->
</script>
<td align="right"><a href="povdoc_068.html">Next</a>&gt;</td></tr>
</table>
</td>
</tr>
</table>
</center>
<div class="divh3">
<h3>3.3.6&nbsp;&nbsp;CSG Pitfalls</h3>

  <p>There is a severe pitfall in the CSG code that we have to be aware of.</p>

</div>

<div class="divh4">
<a name="target_109"></a>
<h4>3.3.6.1&nbsp;&nbsp;Co-incident Surfaces</h4>

  <p>POV-Ray uses inside/outside tests to determine the points at which a ray
  intersects a CSG object. A problem arises when the surfaces of two different
  shapes coincide because there is no way (due to the computer's floating-point
  accuracy) to tell whether a point on the coincident surface belongs to one shape
  or the other.</p><p>
   Look at the following example where a cylinder is used to cut a hole in a
  larger box.</p>
<pre>
  difference {
    box { -1, 1 pigment { Red } }
    cylinder { -z, z, 0.5 pigment { Green } }
  }
</pre>

  <p class="Note"><strong>Note:</strong> that the vectors -1 and 1 in the box definition expand to
  &lt;-1,-1,-1&gt; and &lt;1,1,1&gt; respectively.</p>

  <p>If we trace this object we see red speckles where the hole is supposed to
  be. This is caused by the coincident surfaces of the cylinder and the box.
  One time the cylinder's surface is hit first by a viewing ray, resulting
  in the correct rendering of the hole, and another time the box is hit first,
  leading to a wrong result where the hole vanishes and red speckles appear.
  This problem can be avoided by increasing the size of the cylinder to get rid
  of the coincidence surfaces. This is done by:</p>
<pre>
  difference {
    box { -1, 1 pigment { Red } }
    cylinder { -1.001*z, 1.001*z, 0.5 pigment { Green } }
  }
</pre>

  <p>In general we have to make the subtracted object a little bit larger in a
  CSG difference. We just have to look for coincident surfaces and increase the
  subtracted object appropriately to get rid of those surfaces.</p><p>
   The same problem occurs in CSG intersections and is also avoided by scaling
  some of the involved objects.</p>


</div>
</div>

<p>
<center>
<table width=100% border=0>
<tr>
<td>
<table width=100% align="center" border=0 bgcolor="#ffcc99" class="NavBar">
<tr>
<td align="left">&lt;<a href="povdoc_066.html">Prev</a></td>
<script language="JavaScript">
<!--
if (navigator.userAgent.indexOf ("MSIE 3.") >= 1)
  document.write ("<td align=center><small><i>You are running <b>IE3</b>. This will likely cause problems with this help file.</i></small></td>") ;
else if (navigator.userAgent.indexOf ("MSIE 4.") >= 1)
  document.write ("<td align=center><small><i>The Microsoft HTML Help system works best with <b>IE5</b> or later. We recommend you upgrade.</i></small></td>") ;
//-->
</script>
<td align="right"><a href="povdoc_068.html">Next</a>&gt;</td></tr>
</table>
</td>
</tr>
</table>
</center>
</body>
</html>
