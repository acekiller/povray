<!------------------------------------------------------------------------------->
<!--              Generated by makedocs.pl version 1.0 rev 20                  -->
<!--              This file Copyright (c) POV-Team 1991-2002                   -->
<!-- You can override our stylesheet settings by placing a 'povray35.css' file -->
<!--    in the root directory of the disk volume that holds this help file.    -->
<!------------------------------------------------------------------------------->
<html>
<head>
<title>Vector Expressions</title>
<link rel="stylesheet" type="text/css" href="../povray35.css">
<link rel="stylesheet" type="text/css" href="file:///povray35.css">
<object id=htmlhelp type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"></object>
<script language=javascript src="../povray35.js"></script>
</head>
<a name="target_595"></a>
<body>
<center>
<table width=100% border=0>
<tr>
<td>
<table width=100% align="center" border=0 bgcolor="#ffcc99" class="NavBar">
<tr>
<td align="left">&lt;<a href="povdoc_158.html">Prev</a></td>
<script language="JavaScript">
<!--
if (navigator.userAgent.indexOf ("MSIE 3.") >= 1)
  document.write ("<td align=center><small><i>You are running <b>IE3</b>. This will likely cause problems with this help file.</i></small></td>") ;
else if (navigator.userAgent.indexOf ("MSIE 4.") >= 1)
  document.write ("<td align=center><small><i>The Microsoft HTML Help system works best with <b>IE5</b> or later. We recommend you upgrade.</i></small></td>") ;
//-->
</script>
<td align="right"><a href="povdoc_160.html">Next</a>&gt;</td></tr>
</table>
</td>
</tr>
</table>
</center>
<div class="divh3">
<h3>6.1.4&nbsp;&nbsp;Vector Expressions</h3>

<a name="target_596"></a>

  <p>POV-Ray often requires you to specify a <em>vector</em>. A vector is a set
  of related float values. Vectors may be specified using literals, identifiers
  or functions which return vector values. You may also create very complex
  vector expressions from combinations of any of these using various familiar
  operators.</p><p>
   POV-Ray vectors may have from two to five components but the vast majority
  of vectors have three components. Unless specified otherwise, you should
  assume that the word &quot;vector&quot; means a three component vector.
  POV-Ray operates in a 3D x, y, z coordinate system and you will use three
  component vectors to specify x, y and z values. In some places POV-Ray needs
  only two coordinates. These are often specified by a 2D vector called an <em>
  UV vector</em>. Fractal objects use 4D vectors. Color expressions use 5D
  vectors but allow you to specify 3, 4 or 5 components and use default values
  for the unspecified components. Unless otherwise noted, all 2, 4 or 5
  component vectors work just like 3D vectors but they have a different number
  of components.</p><p>
   The syntax for combining vector literals into vector expressions is almost
  identical to the rules for float expressions. In the syntax for vector
  expressions below, some of the syntax items are defined in the section for
  float expressions. See &quot;<a href="povdoc_158.html#target_531">Float Expressions</a>&quot; for those definitions.
  Detailed explanations of vector-specific issues are given in the following

  sub-sections.</p>
<pre>
VECTOR:
    NUMERIC_TERM [SIGN NUMERIC_TERM]
NUMERIC_TERM:
    NUMERIC_FACTOR [MULT NUMERIC_FACTOR]
NUMERIC_FACTOR:
    VECTOR_LITERAL        | 
    VECTOR_IDENTIFIER     | 
    SIGN NUMERIC_FACTOR   | 
    VECTOR_FUNCTION       |
    VECTOR_BUILT-IN_IDENT | 
    ( FULL_EXPRESSION )   | 
    ! NUMERIC_FACTOR      | 
    FLOAT
VECTOR_LITERAL:
    &lt; FLOAT , FLOAT , FLOAT &gt;
VECTOR_FUNCTION:
    min_extent ( OBJECT_IDENTIFIER )         |
    max_extent ( OBJECT_IDENTIFIER )         |
    trace(OBJECT_IDENTIFIER, VECTOR, VECTOR, [VECTOR_IDENTIFIER] )|
    vaxis_rotate( VECTOR , VECTOR , FLOAT )  |
    vcross( VECTOR , VECTOR )                |
    vrotate( VECTOR , VECTOR )               | 
    vnormalize( VECTOR )                     |
    vturbulence(FLOAT, FLOAT, FLOAT, VECTOR)
VECTOR_BUILT-IN_IDENT:
     x | y | z | t | u | v
</pre>

  <p class="Note">Note: <em>VECTOR_IDENTIFIERS</em> are identifiers previously
  declared to have vector values.</p>

</div>

<div class="divh4">
<a name="target_597"></a>
<h4>6.1.4.1&nbsp;&nbsp;Vector Literals</h4>

  <p>Vector literals consist of two to five float expressions that are
  bracketed by angle brackets <code>&lt;</code> and <code>&gt;</code>. The
  terms are separated by commas. For example here is a typical three component
  vector:</p>
<pre>
 &lt; 1.0, 3.2, -5.4578 &gt;
</pre>

  <p>The commas between components are necessary to keep the program from
  thinking that the 2nd term is the single float expression <code>
  3.2-5.4578</code> and that there is no 3rd term. If you see an error message
  such as &quot;Float expected but '&gt;' found instead&quot; then you
  probably have missed a comma.</p><p>
   Sometimes POV-Ray requires you to specify floats and vectors side-by-side.
  The rules for vector expressions allow for mixing of vectors with vectors or
  vectors with floats so commas are required separators whenever an ambiguity
  might arise. For example <code> &lt;1,2,3&gt;-4</code> evaluates as a mixed
  float and vector expression where 4 is subtracted from each component
  resulting in <code> &lt;-3,-2,-1&gt;</code>. However the comma in <code>
  &lt;1,2,3&gt;,-4</code> means this is a vector followed by a float.</p><p>
   Each component may be a full float expression. For example <code>
  &lt;This+3,That/3,5*Other_Thing&gt;</code> is a valid vector.</p>

</div>

<div class="divh4">
<a name="target_598"></a>
<h4>6.1.4.2&nbsp;&nbsp;Vector Identifiers</h4>

  <p>Vector identifiers may be declared to make scene files more readable and
  to parameterize scenes so that changing a single declaration changes many
  values. An identifier is declared as follows.</p>
<pre>
VECTOR_DECLARATION:
    #declare IDENTIFIER = EXPRESSION; |
    #local IDENTIFIER = EXPRESSION;
</pre>

  <p>Where <em>IDENTIFIER</em> is the name of the identifier up to 40
  characters long and <em>EXPRESSION</em> is any valid expression which
  evaluates to a vector value.</p>
  <p class="Note"><strong>Note:</strong> there should be a semi-colon after the
  expression in a vector declaration. If omitted, it generates a warning and
  some macros may not work properly. See &quot;
  <a href="povdoc_167.html#target_663">#declare vs. #local</a>&quot; for
  information on identifier scope.</p>

  <p>Here are some examples....</p>
<pre>
 #declare Here = &lt;1,2,3&gt;;
 #declare There = &lt;3,4,5&gt;;
 #declare Jump = &lt;Foo*2,Bar-1,Bob/3&gt;;
 #declare Route = There-Here;
 #declare Jump = Jump+&lt;1,2,3&gt;;
</pre>

  <p class="Note"><strong>Note:</strong> you invoke a vector identifier by using its name without any
  angle brackets. As the last example shows, you can re-declare a vector
  identifier and may use previously declared values in that re-declaration.
  There are several built-in identifiers which POV-Ray declares for you. See
  section &quot;<a href="#target_602">Built-in Vector Identifiers</a>&quot; for details.</p>

</div>

<div class="divh4">
<a name="target_599"></a>
<h4>6.1.4.3&nbsp;&nbsp;Vector Operators</h4>

  <p>Vector literals, identifiers and functions may also be combined in
  expressions the same as float values. Operations are performed on a
  component-by-component basis. For example <code>&lt;1,2,3&gt; +
  &lt;4,5,6&gt;</code> evaluates the same as <code>&lt;1+4,2+5,3+6&gt;</code>
  or <code>&lt;5,7,9&gt;</code>. Other operations are done on a similar
  component-by-component basis. For example <code>(&lt;1,2,3&gt; =
  &lt;3,2,1&gt;)</code> evaluates to <code>&lt;0,1,0&gt;</code> because the
  middle components are equal but the others are not. Admittedly this isn't
  very useful but it's consistent with other vector operations.</p><p>
   Conditional expressions such as <code>(C ? A : B)</code> require that <code>
  C</code> is a float expression but <code>A</code> and <code>B</code> may be
  vector expressions. The result is that the entire conditional evaluates as a
  valid vector. For example if <code>Foo</code> and <code> Bar</code> are
  floats then <code>(Foo &lt; Bar ? &lt;1,2,3&gt; : &lt;5,6,7&gt;)</code>
  evaluates as the vector <code>&lt;1,2,3&gt;</code> if <code>Foo</code> is
  less than <code> Bar</code> and evaluates as <code> &lt;5,6,7&gt;</code>
  otherwise.</p><p>
<a name="target_600"></a>

   You may use the dot operator to extract a single float component from a
  vector. Suppose the identifier <code> Spot</code> was previously defined as a
  vector. Then <code>Spot.x</code> is a float value that is the first component
  of this x, y, z vector. Similarly <code>Spot.y</code> and <code>Spot.z</code>
  reference the 2nd and 3rd components. If <code>Spot</code> was a two
  component UV vector you could use <code>Spot.u</code> and <code>Spot.v</code>
  to extract the first and second component. For a 4D vector use <code>
  .x</code>, <code> .y</code>, <code>.z</code>, and <code>.t</code> to extract
  each float component. The dot operator is also used in color expressions
  which are covered later.</p>

</div>

<div class="divh4">
<a name="target_601"></a>
<h4>6.1.4.4&nbsp;&nbsp;Operator Promotion</h4>

  <p>You may use a lone float expression to define a vector whose components
  are all the same. POV-Ray knows when it needs a vector of a particular type
  and will promote a float into a vector if need be. For example the POV-Ray
  <code>scale</code> statement requires a three component vector. If you
  specify <code>scale 5</code> then POV-Ray interprets this as <code>scale
  &lt;5,5,5&gt;</code> which means you want to scale by 5 in every
  direction.</p><p>
   Versions of POV-Ray prior to 3.0 only allowed such use of a float as a
  vector in various limited places such as <code>scale</code> and <code>
  turbulence</code>. However you may now use this trick anywhere. For
  example...</p>
<pre>
 box{0,1}  // Same as box{&lt;0,0,0&gt;,&lt;1,1,1&gt;}
 sphere{0,1} // Same as sphere{&lt;0,0,0&gt;,1}
</pre>

  <p>When promoting a float into a vector of 2, 3, 4 or 5 components, all
  components are set to the float value, however when promoting a vector of a
  lower number of components into a higher order vector, all remaining
  components are set to zero. For example if POV-Ray expects a 4D vector and
  you specify <code>9</code> the result is <code>&lt;9,9,9,9&gt;</code> but if
  you specify <code>&lt;7,6&gt;</code> the result is <code>
  &lt;7,6,0,0&gt;</code>.</p>

</div>

<div class="divh4">
<a name="target_602"></a>
<h4>6.1.4.5&nbsp;&nbsp;Built-in Vector Identifiers</h4>

  <p>There are several built-in vector identifiers. You can use them to specify
  values or to create expressions but you cannot re-declare them to change
  their values. They are:</p>
<pre>
VECTOR_BUILT-IN_IDENT:
    x | y | z | t | u | v
</pre>

  <p>All built-in vector identifiers never change value. They are defined as
  though the following lines were at the start of every scene.</p>
<pre>
 #declare x = &lt;1, 0, 0&gt;;
 #declare y = &lt;0, 1, 0&gt;;
 #declare z = &lt;0, 0, 1&gt;;
 #declare t = &lt;0, 0, 0, 1&gt;;
 #declare u = &lt;1, 0&gt;;
 #declare v = &lt;0, 1&gt;;
</pre>

  <p>The built-in vector identifiers <code>x</code>, <code>y</code>, and <code>
  z</code> provide much greater readability for your scene files when used in
  vector expressions. For example....</p>
<pre>
 plane { y, 1}    // The normal vector is obviously &quot;y&quot;.
 plane { &lt;0,1,0&gt;, 1} // This is harder to read.
 translate 5*x    // Move 5 units in the &quot;x&quot; direction.
 translate &lt;5,0,0&gt;  // This is less obvious.
</pre>

  <p>An expression like <code>5*x</code> evaluates to <code>
  5*&lt;1,0,0&gt;</code> or <code>&lt;5,0,0&gt;</code>.</p><p>
   Similarly <code> u</code> and <code>v</code> may be used in 2D vectors. When
  using 4D vectors you should use <code>x</code>, <code>y</code>, <code>
  z</code>, and <code> t</code> and POV-Ray will promote <code>x</code>, <code>
  y</code>, and <code> z</code> to 4D when used where 4D is required.</p>

</div>

<div class="divh4">
<a name="target_603"></a>
<h4>6.1.4.6&nbsp;&nbsp;Vector Functions</h4>

  <p>POV-Ray defines a variety of built-in functions for manipulating floats,
  vectors and strings. Function calls consist of a keyword which specifies the
  name of the function followed by a parameter list enclosed in parentheses.
  Parameters are separated by commas. For example:</p>
<pre>
 keyword(param1,param2)
</pre>

  <p>The following are the functions which return vector values. They take one
  or more float, integer, vector, or string parameters. Assume that <code>
  A</code> and <code>B</code> are any valid expression that evaluates to a
  vector; and <code>F</code> is any float expression.</p>


<a name="target_604"></a>

<p><code>min_extent ( OBJECT_IDENTIFIER ), max_extent ( OBJECT_IDENTIFIER )</code>.
The <code>min_extent</code> and <code>max_extent</code> return the
minimum and maximum coordinates of a #declared object's bounding box (Corner1
and Corner2), in effect allowing you to find the dimensions and location of the object.</p>

<p class="Note"><strong>Note:</strong> this is not perfect, in some cases (such as CSG intersections and
differences or isosurfaces) the bounding box does not represent the actual dimensions
of the object.</p>
<p>Example:</p>
<pre>
#declare Sphere =
sphere {
  &lt;0,0,0&gt;, 1
  pigment { rgb &lt;1,0,0&gt; }
}
#declare Min = min_extent ( Sphere );
#declare Max = max_extent ( Sphere );
object { Sphere }
box {
    Min, Max
    pigment { rgbf &lt;1,1,1,0.5&gt; }
}
</pre>

<a name="target_605"></a>

<p><code>trace(OBJECT_IDENTIFIER, A, B, [VECTOR_IDENTIFIER])</code>.
<code>trace</code> helps you finding the exact location of a ray intersecting
with an object's surface. It traces a ray beginning at the point <code>A</code>
in the direction specified by the vector <code>B</code>. If the ray
hits the specified object, this function returns the coordinate where the ray intersected
the object. If not, it returns <code>&lt;0,0,0&gt;</code>. If a fourth parameter in the
form of a vector identifier is provided, the normal of the object at the intersection
point (not including any normal perturbations due to textures) is stored into that vector.
If no intersection was found, the normal vector is reset to <code>&lt;0,0,0&gt;</code>.</p>

<p class="Note"><strong>Note:</strong> Checking the normal vector for
<code>&lt;0,0,0&gt;</code> is the only reliable way to determine whether an
intersection has actually occurred, intersections can and do occur anywhere,
including at <code>&lt;0,0,0&gt;</code>.</p>

<p>Example:</p>
<pre>
#declare MySphere = sphere { &lt;0, 0, 0&gt;, 1 } 
#declare Norm = &lt;0, 0, 0&gt;; 
#declare Start = &lt;1, 1, 1&gt;; 
#declare Inter= 
  trace ( MySphere, Start, &lt;0, 0, 0&gt;-Start, Norm ); 
  object { 
    MySphere 
    texture { 
      pigment { rgb 1} 
    } 
  } 
  #if (vlength(Norm)!=0) 
  cylinder { 
    Inter, Inter+Norm, .1 
    texture { 
      pigment {color red 1} 
    } 
  } 
 #end
</pre>


<a name="target_606"></a>

  <p><code>vaxis_rotate(A,B,F)</code> Rotate <code>A</code> about <code>
  B</code> by <code>F</code>. Given the x,y,z coordinates of a point in space
  designated by the vector <code>A</code>, rotate that point about an arbitrary
  axis defined by the vector <code>B</code>. Rotate it through an angle
  specified in degrees by the float value <code>F</code>. The result is a
  vector containing the new x,y,z coordinates of the point.</p>

<a name="target_607"></a>

  <p><code>vcross(A,B)</code> Cross product of <code>A</code> and <code>B</code>. 
  Returns a vector that is the vector cross product of the two vectors. The 
  resulting vector is perpendicular to the two original vectors and its length 
  is equal to the area of the parallelogram defined by them. Or to put in an 
  other way, the cross product can also be formulated as:<em><code>
    AxB = |A| * |B| * sin(angle(A,B)) * perpendicular_unit_vector(A,B)
  </code></em> So the length of the resulting vector is proportional to the sine of the
  angle between <code>A</code> and <code>B</code>. See the animated demo 
  scene <code>VECT2.POV</code> for an illustration.</p>

<a name="target_608"></a>

  <p><code>vnormalize(A)</code> Normalize vector <code> A</code>. Returns a unit
  length vector that is the same direction as <code> A</code>. Formula is <em>
  vnormalize(A)=A/vlength(A)</em>.</p>
  <p class="Warning"><strong>Note:</strong><code>vnormalize(&lt;0,0,0&gt;)</code>
  will result in an error.</p>

<a name="target_609"></a>

  <p><code>vrotate(A,B)</code> Rotate <code> A</code> about origin by <code>
  B</code>. Given the x,y,z coordinates of a point in space designated by the
  vector <code>A</code>, rotate that point about the origin by an amount
  specified by the vector <code>B</code>. Rotate it about the x-axis by an
  angle specified in degrees by the float value <code> B.x</code>. Similarly
  <code> B.y</code> and <code>B.z</code> specify the amount to rotate in
  degrees about the y-axis and z-axis. The result is a vector containing the
  new x,y,z coordinates of the point.</p>

<a name="target_610"></a>

  <p><code>vturbulence(Lambda, Omega, Octaves, A)</code> Turbulence vector at A. Given the
   x,y,z coordinates of a point in space designated by the vector A, return the
   turbulence vector for that point based on the numbers given for Lambda,
   Omega and Octaves. For the meaning of the parameters, check out the Lambda,
   Omega and Octaves sections.<br> 
   The amount of turbulence can be controlled by
   multiplying the turbulence vector by a multiple. The frequency at which the
   turbulence vector changes can be controlled by multiplying A with a
   multiple. The turbulence vector returned by the function can be added to the
   original point A to obtain a turbulated version of the point A. Example :<br>
   <code>#declare MyVector = MyVector + Amount*vturbulence( 2, 0.5, 6,MyVector*Frequency );</code></p>

  <p>See section &quot;<a href="povdoc_158.html#target_553">Float Functions</a>&quot; for other
  functions which are somewhat vector-related but which return floats. In addition to the above
  built-in functions, you may also define your own functions using the <code>#macro</code>
  directive. See the section &quot;<a href="povdoc_173.html#target_693">User Defined Macros</a>&quot;
  for more details.</p>

</div>

<p>
<center>
<table width=100% border=0>
<tr>
<td>
<table width=100% align="center" border=0 bgcolor="#ffcc99" class="NavBar">
<tr>
<td align="left">&lt;<a href="povdoc_158.html">Prev</a></td>
<script language="JavaScript">
<!--
if (navigator.userAgent.indexOf ("MSIE 3.") >= 1)
  document.write ("<td align=center><small><i>You are running <b>IE3</b>. This will likely cause problems with this help file.</i></small></td>") ;
else if (navigator.userAgent.indexOf ("MSIE 4.") >= 1)
  document.write ("<td align=center><small><i>The Microsoft HTML Help system works best with <b>IE5</b> or later. We recommend you upgrade.</i></small></td>") ;
//-->
</script>
<td align="right"><a href="povdoc_160.html">Next</a>&gt;</td></tr>
</table>
</td>
</tr>
</table>
</center>
</body>
</html>
