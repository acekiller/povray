<!------------------------------------------------------------------------------->
<!--              Generated by makedocs.pl version 1.0 rev 20                  -->
<!--              This file Copyright (c) POV-Team 1991-2002                   -->
<!-- You can override our stylesheet settings by placing a 'povray35.css' file -->
<!--    in the root directory of the disk volume that holds this help file.    -->
<!------------------------------------------------------------------------------->
<html>
<head>
<title>Mesh2 Object</title>
<link rel="stylesheet" type="text/css" href="../povray35.css">
<link rel="stylesheet" type="text/css" href="file:///povray35.css">
<object id=htmlhelp type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"></object>
<script language=javascript src="../povray35.js"></script>
</head>
<a name="target_126"></a>
<body>
<center>
<table width=100% border=0>
<tr>
<td>
<table width=100% align="center" border=0 bgcolor="#ffcc99" class="NavBar">
<tr>
<td align="left">&lt;<a href="povdoc_076.html">Prev</a></td>
<script language="JavaScript">
<!--
if (navigator.userAgent.indexOf ("MSIE 3.") >= 1)
  document.write ("<td align=center><small><i>You are running <b>IE3</b>. This will likely cause problems with this help file.</i></small></td>") ;
else if (navigator.userAgent.indexOf ("MSIE 4.") >= 1)
  document.write ("<td align=center><small><i>The Microsoft HTML Help system works best with <b>IE5</b> or later. We recommend you upgrade.</i></small></td>") ;
//-->
</script>
<td align="right"><a href="povdoc_078.html">Next</a>&gt;</td></tr>
</table>
</td>
</tr>
</table>
</center>
<div class="divh3">
<h3>3.5.2&nbsp;&nbsp;Mesh2 Object</h3>

<p>The <code>mesh2</code> is a representation of a mesh, that is much more
like POV-Ray's internal mesh representation than the standard <code>mesh</code>.
As a result, it parses faster and it file size is smaller.</p>
<p>Due to its nature, <code>mesh2</code> is not really suitable for 
building meshes by hand, it is intended for use by modelers and file
format converters. An other option is building the meshes by macros.
Yet, to understand the format, we'll do a small example by hand and go through
all options.</p>

  
<center><img src="images/mesh2.gif" alt="to be written as mesh2"><br><font size=-1><cite>to be written as mesh2</cite></font></center>


<p>We will turn the mesh sketched above into a <code>mesh2</code> object.
The mesh is made of 8 triangles, each with 3 vertices, many of 
these vertices are shared among the triangles. This can later be
used to optimize the mesh. First we will set it up straight forward.</p>

<p>In <code>mesh2</code> all the vertices are listed in a list named
<code>vertex_vectors{}</code>. A second list, <code>face_indices{}</code>,
tells us how to put together three vertices to create one triangle,
by pointing to the index number of a vertex. All lists in <code>mesh2</code>
are zero based, the number of the first vertex is 0. The very first
item in a list is the amount of vertices, normals or uv_vectors it contains.
<code>mesh2</code> has to be specified in the order <em>VECTORS...</em>,
<em>LISTS...</em>, <em>INDICES...</em>.</p>

<p>Lets go through the mesh above, we do it counter clockwise. The total 
amount of vertices is 24 (8 triangle * 3 vertices).</p>

<pre>
mesh2 {
   vertex_vectors {
      24,
      ...
</pre>

<p>Now we can add the coordinates of the vertices of the first triangle:</p>

<pre>
mesh2 {
   vertex_vectors {
      24, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;
      ..
</pre>

<p>Next step, is to tell the mesh how the triangle should be created;
There will be a total of 8 face_indices (8 triangles). The first
point in the first face, points to the first vertex_vector (0: &lt;0,0,0&gt;), 
the second to the second (1: &lt;0.5,0,0&gt;), etc...</p>

<pre>
mesh2 {
   vertex_vectors {
      24, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;
      ...
   }
   face_indices {
      8, 
      &lt;0,1,2&gt; 
      ...
</pre>

<p>The complete mesh:</p>

<pre>
mesh2 {
   vertex_vectors {
      24, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;, //1
      &lt;0.5,0,0&gt;, &lt;1,0,0&gt;, &lt;0.5,0.5,0&gt;, //2
      &lt;1,0,0&gt;, &lt;1,0.5,0&gt;, &lt;0.5,0.5,0&gt;, //3
      &lt;1,0.5,0&gt;, &lt;1,1,0&gt;, &lt;0.5,0.5,0&gt;, //4
      &lt;1,1,0&gt;, &lt;0.5,1,0&gt;, &lt;0.5,0.5,0&gt;, //5
      &lt;0.5,1,0&gt;, &lt;0,1,0&gt;, &lt;0.5,0.5,0&gt;, //6
      &lt;0,1,0&gt;, &lt;0,0.5,0&gt;, &lt;0.5,0.5,0&gt;, //7
      &lt;0,0.5,0&gt;, &lt;0,0,0&gt;, &lt;0.5,0.5,0&gt;  //8
   }
   face_indices {
      8, 
      &lt;0,1,2&gt;,    &lt;3,4,5&gt;,       //1 2
      &lt;6,7,8&gt;,    &lt;9,10,11&gt;,     //3 4
      &lt;12,13,14&gt;, &lt;15,16,17&gt;,    //5 6
      &lt;18,19,20&gt;, &lt;21,22,23&gt;     //7 8
   }
   pigment {rgb 1}
}
</pre>

<p>As mentioned earlier, many vertices are shared by triangles. We can 
optimize the mesh by removing all duplicate vertices but one. In the 
example this reduces the amount from 24 to 9.</p>

<pre>
mesh2 {
   vertex_vectors {
      9, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;,
      /*as 1*/ &lt;1,0,0&gt;,   /*as 2*/
      /*as 3*/ &lt;1,0.5,0&gt;, /*as 2*/
      /*as 4*/ &lt;1,1,0&gt;,   /*as 2*/
      /*as 5*/ &lt;0.5,1,0&gt;, /*as 2*/
      /*as 6*/ &lt;0,1,0&gt;,   /*as 2*/
      /*as 7*/ &lt;0,0.5,0&gt;, /*as 2*/
      /*as 8*/ /*as 0*/   /*as 2*/
   }
   ...
   ...
</pre>

<p>Next step is to rebuild the list of face_indices, as they now point 
to indices in the <code>vertex_vector{}</code> list that don't exist anymore.</p>

<pre>
   ...
   ...
   face_indices {
      8, 
      &lt;0,1,2&gt;, &lt;1,3,2&gt;,
      &lt;3,4,2&gt;, &lt;4,5,2&gt;,
      &lt;5,6,2&gt;, &lt;6,7,2&gt;,
      &lt;7,8,2&gt;, &lt;8,0,2&gt;
   }
   pigment {rgb 1}
}
</pre>


</div>

<div class="divh4">
<a name="target_127"></a>
<h4>3.5.2.1&nbsp;&nbsp;Smooth triangles and mesh2</h4>

<p>In case we want a smooth mesh, the same steps we did also apply to the 
normals in a mesh. For each vertex there is one normal vector listed in 
<code>normal_vectors{}</code>, duplicates can be removed. If the number
of normals equals the number of vertices then the <code>normal_indices{}</code>
list is optional and the indexes from the <code>face_indices{}</code> list
are used instead.</p>

<pre>
mesh2 {
   vertex_vectors {
      9, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;,
      &lt;1,0,0&gt;, &lt;1,0.5,0&gt;, &lt;1,1,0&gt;,
      &lt;0.5,1,0&gt;, &lt;0,1,0&gt;, &lt;0,0.5,0&gt;   
   }
   normal_vectors {
      9,
     &lt;-1,-1,0&gt;,&lt;0,-1,0&gt;, &lt;0,0,1&gt;,
      /*as 1*/ &lt;1,-1,0&gt;, /*as 2*/
      /*as 3*/ &lt;1,0,0&gt;,  /*as 2*/
      /*as 4*/ &lt;1,1,0&gt;,  /*as 2*/
      /*as 5*/ &lt;0,1,0&gt;,  /*as 2*/
      /*as 6*/ &lt;-1,1,0&gt;, /*as 2*/
      /*as 7*/ &lt;-1,0,0&gt;, /*as 2*/
      /*as 8*/ /*as 0*/  /*as 2*/ 
   }
   face_indices {
      8, 
      &lt;0,1,2&gt;, &lt;1,3,2&gt;,
      &lt;3,4,2&gt;, &lt;4,5,2&gt;,
      &lt;5,6,2&gt;, &lt;6,7,2&gt;,
      &lt;7,8,2&gt;, &lt;8,0,2&gt;
   }
   pigment {rgb 1}
}
</pre>

<p>When a mesh has a mix of smooth and flat triangles a list of 
<code>normal_indices{}</code> has to be added, where each entry points to what 
vertices a normal should be applied. In the example below only the first four
normals are actually used.</p>

<pre>
mesh2 {
   vertex_vectors {
      9, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;,
      &lt;1,0,0&gt;, &lt;1,0.5,0&gt;, &lt;1,1,0&gt;,
      &lt;0.5,1,0&gt;, &lt;0,1,0&gt;,   &lt;0,0.5,0&gt;
   }
   normal_vectors {
      9,
      &lt;-1,-1,0&gt;, &lt;0,-1,0&gt;, &lt;0,0,1&gt;,
      &lt;1,-1,0&gt;, &lt;1,0,0&gt;, &lt;1,1,0&gt;,
      &lt;0,1,0&gt;, &lt;-1,1,0&gt;, &lt;-1,0,0&gt;
   }
   face_indices {
      8, 
      &lt;0,1,2&gt;, &lt;1,3,2&gt;,
      &lt;3,4,2&gt;, &lt;4,5,2&gt;,
      &lt;5,6,2&gt;, &lt;6,7,2&gt;,
      &lt;7,8,2&gt;, &lt;8,0,2&gt;
   }
   normal_indices {
      4, 
      &lt;0,1,2&gt;, &lt;1,3,2&gt;,
      &lt;3,4,2&gt;, &lt;4,5,2&gt;
   }
   pigment {rgb 1}
}
</pre>

</div>

<div class="divh4">
<a name="target_128"></a>
<h4>3.5.2.2&nbsp;&nbsp;UV mapping and mesh2</h4>

<p>uv_mapping is a method of 'sticking' 2D textures on an object in such a way that it
follows the form of the object. For uv_mapping on triangles imagine it as follows; 
First you cut out a triangular section of a texture form the xy-plane. Then stretch,
shrink and deform the piece of texture to fit to the triangle and stick it on.</p>

<p>Now, in <code>mesh2</code> we first build a list of 2D-vectors that are the coordinates of the
triangular sections in the xy-plane. This is the <code>uv_vectors{}</code> list. In the example we
map the texture from the rectangular area <nobr><code>&lt;-0.5,-0.5&gt;, &lt;0.5,0.5&gt;</code></nobr> to the triangles in the mesh. 
Again we can omit all duplicate coordinates</p>

<pre>
mesh2 {
   vertex_vectors {
      9, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;,
      &lt;1,0,0&gt;, &lt;1,0.5,0&gt;, &lt;1,1,0&gt;,
      &lt;0.5,1,0&gt;, &lt;0,1,0&gt;,   &lt;0,0.5,0&gt;
   }
   uv_vectors {
      9
     &lt;-0.5,-0.5&gt;,&lt;0,-0.5&gt;,  &lt;0,0&gt;,
      /*as 1*/   &lt;0.5,-0.5&gt;,/*as 2*/
      /*as 3*/   &lt;0.5,0&gt;,   /*as 2*/
      /*as 4*/   &lt;0.5,0.5&gt;, /*as 2*/
      /*as 5*/   &lt;0,0.5&gt;,   /*as 2*/
      /*as 6*/   &lt;-0.5,0.5&gt;,/*as 2*/
      /*as 7*/   &lt;-0.5,0&gt;,  /*as 2*/
      /*as 8*/   /*as 0*/   /*as 2*/       
   }
   face_indices {
      8, 
      &lt;0,1,2&gt;, &lt;1,3,2&gt;,
      &lt;3,4,2&gt;, &lt;4,5,2&gt;,
      &lt;5,6,2&gt;, &lt;6,7,2&gt;,
      &lt;7,8,2&gt;, &lt;8,0,2&gt;
   }
   uv_mapping
   pigment {wood scale 0.2}
}
</pre>

<p>Just as with the <code>normal_vectors</code>, if the number
of <code>uv_vectors</code> equals the number of vertices then the <code>uv_indices{}</code>
list is optional and the indices from the <code>face_indices{}</code> list
are used instead.</p>

<p>In contrary to the <code>normal_indices</code> list, if the <code>uv_indices</code>
list is used, the amount of indices should be equal to the amount of <code>face_indices</code>.
In the example below only 'one texture section' is specified and used on all triangles, using the
<code>uv_indices</code>.</p>
<pre>
mesh2 {
   vertex_vectors {
      9, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;,
      &lt;1,0,0&gt;, &lt;1,0.5,0&gt;, &lt;1,1,0&gt;,
      &lt;0.5,1,0&gt;, &lt;0,1,0&gt;,   &lt;0,0.5,0&gt;
   }
   uv_vectors {
      3
      &lt;0,0&gt;, &lt;0.5,0&gt;, &lt;0.5,0.5&gt;    
   }
   face_indices {
      8, 
      &lt;0,1,2&gt;, &lt;1,3,2&gt;,
      &lt;3,4,2&gt;, &lt;4,5,2&gt;,
      &lt;5,6,2&gt;, &lt;6,7,2&gt;,
      &lt;7,8,2&gt;, &lt;8,0,2&gt;
   }
   uv_indices {
      8, 
      &lt;0,1,2&gt;, &lt;0,1,2&gt;,
      &lt;0,1,2&gt;, &lt;0,1,2&gt;,
      &lt;0,1,2&gt;, &lt;0,1,2&gt;,
      &lt;0,1,2&gt;, &lt;0,1,2&gt;
   }
   uv_mapping
   pigment {gradient x scale 0.2}
}
</pre>


</div>

<div class="divh4">
<a name="target_129"></a>
<h4>3.5.2.3&nbsp;&nbsp;A separate texture per triangle</h4>

<p>By using the <code>texture_list</code> it is possible to specify a texture per triangle
or even per vertex in the mesh. In the latter case the three textures per triangle will
be interpolated. To let POV-Ray know what texture to apply to a triangle, the index of a
texture is added to the <code>face_indices</code> list, after the face index it belongs to.</p>

<pre>
mesh2 {
   vertex_vectors {
      9, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;,
      &lt;1,0,0&gt;, &lt;1,0.5,0&gt;, &lt;1,1,0&gt;   
      &lt;0.5,1,0&gt;, &lt;0,1,0&gt;, &lt;0,0.5,0&gt; 
   }
   texture_list {
      2,
      texture{pigment{rgb&lt;0,0,1&gt;}}
      texture{pigment{rgb&lt;1,0,0&gt;}}
   }
   face_indices {
      8, 
      &lt;0,1,2&gt;,0,  &lt;1,3,2&gt;,1,
      &lt;3,4,2&gt;,0,  &lt;4,5,2&gt;,1,
      &lt;5,6,2&gt;,0,  &lt;6,7,2&gt;,1,
      &lt;7,8,2&gt;,0,  &lt;8,0,2&gt;,1
   }
}
</pre>

<p>To specify a texture per vertex, three <code>texture_list</code> indices are added after
the <code>face_indices</code></p>

<pre>
mesh2 {
   vertex_vectors {
      9, 
      &lt;0,0,0&gt;, &lt;0.5,0,0&gt;, &lt;0.5,0.5,0&gt;,
      &lt;1,0,0&gt;, &lt;1,0.5,0&gt;, &lt;1,1,0&gt;   
      &lt;0.5,1,0&gt;, &lt;0,1,0&gt;, &lt;0,0.5,0&gt; 
   }
   texture_list {
      3,
      texture{pigment{rgb &lt;0,0,1&gt;}}
      texture{pigment{rgb 1}}
      texture{pigment{rgb &lt;1,0,0&gt;}}
   }
   face_indices {
      8, 
      &lt;0,1,2&gt;,0,1,2,  &lt;1,3,2&gt;,1,0,2,
      &lt;3,4,2&gt;,0,1,2,  &lt;4,5,2&gt;,1,0,2,
      &lt;5,6,2&gt;,0,1,2,  &lt;6,7,2&gt;,1,0,2,
      &lt;7,8,2&gt;,0,1,2,  &lt;8,0,2&gt;,1,0,2
   }
}
</pre>

<p>Assigning a texture based on the <code>texture_list</code> and texture
interpolation is done on a per triangle base. So it is possible to mix
triangles with just one texture and triangles with three textures in a mesh.
It is even possible to mix in triangles without any texture indices, these
will get their texture from a general <code>texture</code> statement in the
<code>mesh2</code>. uv_mapping is supported for texturing using a <code>texture_list</code>.</p>

</div>

<p>
<center>
<table width=100% border=0>
<tr>
<td>
<table width=100% align="center" border=0 bgcolor="#ffcc99" class="NavBar">
<tr>
<td align="left">&lt;<a href="povdoc_076.html">Prev</a></td>
<script language="JavaScript">
<!--
if (navigator.userAgent.indexOf ("MSIE 3.") >= 1)
  document.write ("<td align=center><small><i>You are running <b>IE3</b>. This will likely cause problems with this help file.</i></small></td>") ;
else if (navigator.userAgent.indexOf ("MSIE 4.") >= 1)
  document.write ("<td align=center><small><i>The Microsoft HTML Help system works best with <b>IE5</b> or later. We recommend you upgrade.</i></small></td>") ;
//-->
</script>
<td align="right"><a href="povdoc_078.html">Next</a>&gt;</td></tr>
</table>
</td>
</tr>
</table>
</center>
</body>
</html>
